# =============================================================================
# Configuration Defaults
# =============================================================================
- defaults:
    link:
        create: true
        relink: true
        glob: true
        force: false
    shell:
        stdin: true
        stdout: true
        stderr: true

# =============================================================================
# Symlinks
# =============================================================================
- clean: ['~', '~/.config/nvim']

- link:
    # Neovim configuration
    ~/.config/nvim/: nvim/*

    # Zsh configuration (consolidated into single .zshrc file)
    ~/.zshrc: .zshrc
    ~/.zsh_plugins.txt: .zsh_plugins.txt

    # Tmux and Git configuration
    ~/.tmux.conf: .tmux.conf
    ~/.gitconfig: .gitconfig
    ~/.global_gitignore: .global_gitignore

    # Starship prompt configuration
    ~/.config/starship.toml: starship.toml

- create:
    - ~/.vim/undo-history

# =============================================================================
# Dotbot Setup
# =============================================================================
- shell:
    - [git submodule update --init --recursive, Installing submodules]

# =============================================================================
# Git Configuration (Personal)
# =============================================================================
- shell:
    - |
      # Create .gitconfig.local if it doesn't exist
      if [ ! -f ~/.gitconfig.local ]; then
          echo "Setting up your Git identity..."
          read -p "Enter your name: " git_name
          read -p "Enter your email: " git_email
          cat > ~/.gitconfig.local << EOF
      # Local Git Configuration (not tracked in dotfiles repo)
      # Contains personal information like email and name

      [user]
      	name = $git_name
      	email = $git_email
      EOF
          echo "✓ Created ~/.gitconfig.local"
      else
          echo "✓ ~/.gitconfig.local already exists"
      fi

# =============================================================================
# Shell Tools (zsh, antidote, zoxide, tmux, fzf)
# =============================================================================
- shell:
    - [sudo apt install -y zsh ripgrep fd-find]
    - ['[ -L ~/.local/bin/fd ] || ln -s $(which fdfind) ~/.local/bin/fd', 'Create fd symlink (fdfind -> fd)']
    - ['[ "$SHELL" = "$(which zsh)" ] || chsh -s $(which zsh)', 'Set zsh as default shell (skip if already set)']
    - ['[ -d ${ZDOTDIR:-~}/.antidote ] || git clone --depth=1 https://github.com/mattmc3/antidote.git ${ZDOTDIR:-~}/.antidote', 'Install antidote']
    - ['[ -x ~/.local/bin/zoxide ] || curl -sS https://raw.githubusercontent.com/ajeetdsouza/zoxide/main/install.sh | bash', 'Install zoxide']
    - [bash install_fzf.sh, Install latest fzf binary]
    - ['[ -x ~/.local/bin/starship ] || curl -sS https://starship.rs/install.sh | sh -s -- -y -b ~/.local/bin', 'Install Starship prompt']
    - ['[ -d ~/.tmux/plugins/tpm ] || git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm', 'Install TPM (tmux plugin manager)']
      #- [source ~/.zshrc && ./install_tmux.sh, Install tmux] # TODO: Installing plugins currently not working...

# =============================================================================
# Nneovim
# =============================================================================
- shell:
    - [bash setup_nvim.sh, setup neovim]

